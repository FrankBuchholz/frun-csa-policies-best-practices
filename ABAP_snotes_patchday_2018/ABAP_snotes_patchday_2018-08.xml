<?xml version="1.0" encoding="utf-16"?>
<!--
This FRUN CSA policy contains rules to check the following ABAP SNotes:

SAP Security Patch Day: 2018 08
0002633180
0002671160

Version: 002
Date:    August 28 2018
-->
<targetsystem desc="SNotes of PatchDay: 2018-08" id="PatchDay_2018-08" multisql="Yes">
  <!-- CA-UI5-ABA-SAR - [CVE-2018-2434] Content Spoofing vulnerability in SAP_UI com (Version 0007 ) (Medium)  -->
  <configstore name="ABAP_NOTES">
    <checkitem desc="Note 0002633180 exists" id="0002633180" operator="check_note">
      <compliant>NOTE = '0002633180'</compliant>
      <noncompliant/>
    </checkitem>
  </configstore>
  <configstore name="COMP_LEVEL">
  <checkitem desc="Note 0002633180 missing and solution with SP available" id="0002633180" operator="check_note:0002633180">
     <compliant>(
       ( COMPONENT = 'UI_700' and VERSION = '200' and not( to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;   13 )   ) <!-- UI_700 200 SAPK-20013INUI700 -->   or
       ( COMPONENT = 'UI_700' and VERSION = '750' and not( to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;   13 )   ) <!-- UI_700 750 SAPK-75013INSAPUI -->   or
       ( COMPONENT = 'UI_700' and VERSION = '751' and not( to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;    7 )   ) <!-- UI_700 751 SAPK-75107INSAPUI -->   or
       ( COMPONENT = 'UI_700' and VERSION = '752' and not( to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;    4 )   ) <!-- UI_700 752 SAPK-75204INSAPUI -->   
     )</compliant>
     <noncompliant>(
       ( COMPONENT = 'UI_700' and VERSION = '200' and to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;   13 )  <!-- UI_700 200 SAPK-20013INUI700 -->   or
       ( COMPONENT = 'UI_700' and VERSION = '750' and to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;   13 )  <!-- UI_700 750 SAPK-75013INSAPUI -->   or
       ( COMPONENT = 'UI_700' and VERSION = '751' and to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;    7 )  <!-- UI_700 751 SAPK-75107INSAPUI -->   or
       ( COMPONENT = 'UI_700' and VERSION = '752' and to_integer( COALESCE(NULLIF(SP,''),'0') ) &lt;    4 )  <!-- UI_700 752 SAPK-75204INSAPUI -->   
     )</noncompliant>
    </checkitem>
  </configstore>
  <configstore name="COMP_LEVEL">
  <checkitem desc="Note 0002633180 missing and applicable using Correction Instruction" id="0002633180" operator="check_note:0002633180">
    <compliant/>
    <noncompliant>(
 ( COMPONENT = 'SAP_UI' and VERSION = '740' and to_integer( COALESCE(NULLIF(SP,''),'0' ) ) between    0 and   19 )  <!-- SAP_UI 740 740 - SAPK-74019INSAPUI  -->
 or ( COMPONENT = 'SAP_UI' and VERSION = '750' and to_integer( COALESCE(NULLIF(SP,''),'0' ) ) between    0 and   12 )  <!-- SAP_UI 750 750 - SAPK-75012INSAPUI  -->
 or ( COMPONENT = 'SAP_UI' and VERSION = '751' and to_integer( COALESCE(NULLIF(SP,''),'0' ) ) between    0 and    6 )  <!-- SAP_UI 751 751 - SAPK-75106INSAPUI  -->
 or ( COMPONENT = 'SAP_UI' and VERSION = '752' and to_integer( COALESCE(NULLIF(SP,''),'0' ) ) between    0 and    3 )  <!-- SAP_UI 752 752 - SAPK-75203INSAPUI  -->
 or ( COMPONENT = 'UI_700' and VERSION = '200' and to_integer( COALESCE(NULLIF(SP,''),'0' ) ) between    0 and   12 )  <!-- UI_700 200 200 - SAPK-20012INUI700  -->
 or ( COMPONENT = 'UI_INFRA' and VERSION = '100' and to_integer( COALESCE(NULLIF(SP,''),'0' ) ) between    0 and   19 )  <!-- UI_INFRA 100 100 - SAPK-10019INUIINFRA  -->
  )</noncompliant>
    </checkitem>
  </configstore>
  <!-- BC-CTS-TMS 2671160 - [CVE-2018-2441] Missing input validation in ABAP Change and Transport System (CTS) -->  
  <configstore name="SAP_KERNEL">
    <checkitem desc="kernel version which note 0002671160 recommends" id="0002671160">
      <compliant>NAME = 'KERN_PATCHLEVEL' and lpad(VALUE,4,'0') &gt;= '1112'</compliant>
      <noncompliant>NAME = 'KERN_PATCHLEVEL'and lpad(VALUE,4,'0') &lt; '1112'</noncompliant>
      <joinstore name="SAP_KERNEL" no_data_found="Yes">
        <joincompliant>NAME = 'KERN_REL' and VALUE = '721_REL'</joincompliant>
        <joinnoncompliant>NAME = 'KERN_REL' and VALUE = '721_REL'</joinnoncompliant>
      </joinstore>
    </checkitem>
    <checkitem desc="kernel version which note 0002671160 recommends" id="0002671160">
      <compliant>NAME = 'KERN_PATCHLEVEL' and lpad(VALUE,3,'0') &gt;= '625'</compliant>
      <noncompliant>NAME = 'KERN_PATCHLEVEL'and lpad(VALUE,3,'0') &lt; '625'</noncompliant>
      <joinstore name="SAP_KERNEL" no_data_found="Yes">
        <joincompliant>NAME = 'KERN_REL' and VALUE = '722_REL'</joincompliant>
        <joinnoncompliant>NAME = 'KERN_REL' and VALUE = '722_REL'</joinnoncompliant>
      </joinstore>
    </checkitem>
    <checkitem desc="kernel version which note 0002671160 recommends" id="0002671160">
      <compliant>NAME = 'KERN_PATCHLEVEL' and lpad(VALUE,3,'0') &gt;= '810'</compliant>
      <noncompliant>NAME = 'KERN_PATCHLEVEL'and lpad(VALUE,3,'0') &lt; '810'</noncompliant>
      <joinstore name="SAP_KERNEL" no_data_found="Yes">
        <joincompliant>NAME = 'KERN_REL' and VALUE = '745_REL'</joincompliant>
        <joinnoncompliant>NAME = 'KERN_REL' and VALUE = '745_REL'</joinnoncompliant>
      </joinstore>
    </checkitem>
    <checkitem desc="kernel version which note 0002671160 recommends" id="0002671160">
      <compliant>NAME = 'KERN_PATCHLEVEL' and lpad(VALUE,3,'0') &gt;= '521'</compliant>
      <noncompliant>NAME = 'KERN_PATCHLEVEL'and lpad(VALUE,3,'0') &lt; '521'</noncompliant>
      <joinstore name="SAP_KERNEL" no_data_found="Yes">
        <joincompliant>NAME = 'KERN_REL' and VALUE = '749_REL'</joincompliant>
        <joinnoncompliant>NAME = 'KERN_REL' and VALUE = '749_REL'</joinnoncompliant>
      </joinstore>
    </checkitem>
    <checkitem desc="kernel version which note 0002671160 recommends" id="0002671160">
      <compliant>NAME = 'KERN_PATCHLEVEL' and lpad(VALUE,3,'0') &gt;= '220'</compliant>
      <noncompliant>NAME = 'KERN_PATCHLEVEL'and lpad(VALUE,3,'0') &lt; '220'</noncompliant>
      <joinstore name="SAP_KERNEL" no_data_found="Yes">
        <joincompliant>NAME = 'KERN_REL' and VALUE = '753_REL'</joincompliant>
        <joinnoncompliant>NAME = 'KERN_REL' and VALUE = '753_REL'</joinnoncompliant>
      </joinstore>
    </checkitem>
    <checkitem desc="kernel version which note 0002671160 recommends" id="0002671160">
      <compliant>NAME = 'KERN_PATCHLEVEL' and lpad(VALUE,3,'0') &gt;= '011'</compliant>
      <noncompliant>NAME = 'KERN_PATCHLEVEL'and lpad(VALUE,3,'0') &lt; '011'</noncompliant>
      <joinstore name="SAP_KERNEL" no_data_found="Yes">
        <joincompliant>NAME = 'KERN_REL' and VALUE = '773_REL'</joincompliant>
        <joinnoncompliant>NAME = 'KERN_REL' and VALUE = '773_REL'</joinnoncompliant>
      </joinstore>
    </checkitem>
  </configstore>
</targetsystem>
